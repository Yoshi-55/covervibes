<% if @random_track %>
    <div x-data="{ open: false, iframeKey: 0 }" class="mt-8 flex justify-center">
        <% if @random_track.album && @random_track.album.images.any? %>
                    <img src="<%= @random_track.album.images.first['url'] %>" alt="ジャケット画像"
                        class="my-4 object-cover rounded shadow cursor-pointer"
                        style="width:350px; height:350px;"
                        @click="open = true"
                        :class="document.documentElement.getAttribute('data-theme') === 'black' ? 'grayscale' : ''"
                    />
            <!-- Modal -->
            <dialog :open="open" class="modal" @close="iframeKey++">
                <form method="dialog" class="modal-backdrop" @click="open = false; iframeKey++">
                    <button>close</button>
                </form>
                <div class="modal-box relative">
                    <button @click="open = false; iframeKey++" class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button>
                                <img src="<%= @random_track.album.images.first['url'] %>" alt="ジャケット画像"
                                    class="object-contain mx-auto"
                                    style="width:500px; height:500px;"
                                    :class="document.documentElement.getAttribute('data-theme') === 'black' ? 'grayscale' : ''"
                                />
                    <div class="text-center mt-4 space-y-1">
                        <div class="text-xl font-bold text-primary">
                            <%= @random_track.name %>
                        </div>
                        <div class="text-base text-secondary">
                            <%= @random_track.artists.map(&:name).join(', ') %>
                        </div>
                        <div class="text-sm text-accent">
                            <a href="<%= @random_track.album.external_urls['spotify'] %>" target="_blank" rel="noopener" class="link link-hover">
                                <%= @random_track.album.name %>
                            </a>
                        </div>
                    </div>
                    <% if @random_track.external_urls['spotify'] %>
                        <div class="mt-4 flex justify-center">
                            <template x-if="open">
                                <iframe :key="iframeKey" src="https://open.spotify.com/embed/track/<%= @random_track.id %>" width="500" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media" class="rounded-2xl" :class="document.documentElement.getAttribute('data-theme') === 'black' ? 'grayscale' : ''"></iframe>
                            </template>
                        </div>
                    <% end %>
                </div>
            </dialog>
        <% end %>
    </div>
<% else %>
    <p>曲が取得できませんでした。</p>
<% end %>
